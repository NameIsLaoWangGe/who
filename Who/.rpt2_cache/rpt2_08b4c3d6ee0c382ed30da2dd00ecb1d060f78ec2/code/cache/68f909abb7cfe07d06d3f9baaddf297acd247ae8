{
  "code": "import { lwg, EventAdmin } from \"../Lwg_Template/lwg\";\r\nimport { GSene3D } from \"../Lwg_Template/Global\";\r\nexport default class GameMain3D_Blade extends lwg.Admin.Object3D {\r\n    onTriggerEnter(other) {\r\n        if (!lwg.Admin._gameStart) {\r\n            return;\r\n        }\r\n        let otherOwner = other.owner;\r\n        let otherOwnerParent = otherOwner.parent;\r\n        switch (otherOwner.name) {\r\n            case 'Hairline':\r\n                let length = otherOwnerParent.transform.localScaleY * 2 * otherOwner.transform.localScaleY;\r\n                let HairlineH = lwg.Tools.dotRotateXY(otherOwnerParent.transform.position.x, otherOwnerParent.transform.position.y, otherOwnerParent.transform.position.x, otherOwnerParent.transform.position.y + length, otherOwnerParent.transform.localRotationEulerZ).y - otherOwnerParent.transform.position.y;\r\n                let diffY = Math.abs((this.selfTransform.position.y - this.self.transform.localScaleY / 2) - otherOwnerParent.transform.position.y);\r\n                let cutH = HairlineH - diffY;\r\n                let cutRatio = cutH / HairlineH;\r\n                otherOwnerParent.transform.localScaleY -= otherOwnerParent.transform.localScaleY * cutRatio;\r\n                if (otherOwnerParent['HairLen']) {\r\n                    otherOwnerParent['HairLen'].setValue = otherOwnerParent.transform.localScaleY;\r\n                }\r\n                if (Math.floor(Math.random() * 4) === 1) {\r\n                    if (cutH >= 0.01) {\r\n                        let cutHair = otherOwnerParent.clone();\r\n                        cutHair.transform.localScaleY = cutHair.transform.localScaleY * cutRatio;\r\n                        let CutHairParent = GSene3D.Head.getChildByName('CutHairParent');\r\n                        cutHair.name = 'cutHair';\r\n                        CutHairParent.addChild(cutHair);\r\n                        cutHair.transform.position = this.self.transform.position;\r\n                        let cutHairline = cutHair.getChildAt(0);\r\n                        cutHairline.name = 'cutHairline';\r\n                        let rig3D = cutHairline.getComponent(Laya.Rigidbody3D);\r\n                        rig3D.isKinematic = false;\r\n                        rig3D.gravity = (new Laya.Vector3(0, -3, 3));\r\n                        rig3D.rollingFriction = 0;\r\n                        rig3D.restitution = 0;\r\n                        Laya.timer.once(3000, this, f => { cutHair.removeSelf(); });\r\n                    }\r\n                }\r\n                break;\r\n            case 'standard':\r\n                console.log('碰到线了，游戏失败！');\r\n                EventAdmin.notify(EventAdmin.EventType.defeated);\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n    }\r\n}\r\n",
  "references": [
    "D:/Game/project/CutHair/Project/CutHair/src/script/Lwg_Template/lwg.ts",
    "D:/Game/project/CutHair/Project/CutHair/src/script/Lwg_Template/Global.ts"
  ]
}
