{
  "code": "import { Gold, EventAdmin, Click, Shop, Tools, Dialog, PalyAudio, Setting } from \"../Lwg_Template/lwg\";\r\nimport { GVariate } from \"../Lwg_Template/Global\";\r\nimport ADManager, { TaT } from \"../TJ/Admanager\";\r\nimport { Game } from \"../Lwg_Template/Game\";\r\nexport default class UIShop extends Shop.ShopScene {\r\n    shopOnAwake() {\r\n        ADManager.TAPoint(TaT.BtnShow, 'ADrewardbt_skin');\r\n        ADManager.TAPoint(TaT.BtnShow, 'closeword_skin');\r\n        ADManager.TAPoint(TaT.BtnShow, 'Adcoinget');\r\n        ADManager.TAPoint(TaT.BtnShow, 'Adxiangsu_get');\r\n        ADManager.TAPoint(TaT.BtnShow, 'Adjiguangjjian_get');\r\n        ADManager.TAPoint(TaT.BtnShow, 'Admyworld_get');\r\n        ADManager.TAPoint(TaT.BtnShow, 'Adcat_get');\r\n        ADManager.TAPoint(TaT.BtnShow, 'Adstar_get');\r\n        ADManager.TAPoint(TaT.BtnShow, 'Adanquan_get');\r\n        ADManager.TAPoint(TaT.BtnShow, 'Adtomato_get');\r\n        ADManager.TAPoint(TaT.BtnShow, 'Adiron_get');\r\n        ADManager.TAPoint(TaT.BtnShow, 'Adhama_get');\r\n        ADManager.TAPoint(TaT.BtnShow, 'ADyuan_ge');\r\n        ADManager.TAPoint(TaT.BtnShow, 'ADjiemao1_get');\r\n        ADManager.TAPoint(TaT.BtnShow, 'ADjiemao2_get');\r\n        Gold.goldAppear();\r\n        Setting.setBtnVinish();\r\n        GVariate._stageClick = false;\r\n        Shop.goodsClassArr = [Shop.allOther, Shop.allProps, Shop.allSkin];\r\n        let SkinName;\r\n        (function (SkinName) {\r\n            SkinName[\"anquanmao\"] = \"anquanmao\";\r\n            SkinName[\"yuanyanjing\"] = \"yuanyanjing\";\r\n            SkinName[\"jiemao_01\"] = \"jiemao_01\";\r\n            SkinName[\"hamajing\"] = \"hamajing\";\r\n            SkinName[\"yanshemao_gangtie\"] = \"yanshemao_gangtie\";\r\n            SkinName[\"yanshemao\"] = \"yanshemao\";\r\n            SkinName[\"jiemao_02\"] = \"jiemao_02\";\r\n            SkinName[\"xiaochoumao\"] = \"xiaochoumao\";\r\n            SkinName[\"xingxingyanjing\"] = \"xingxingyanjing\";\r\n            SkinName[\"yanshemao_shijie\"] = \"yanshemao_shijie\";\r\n            SkinName[\"maomaozi\"] = \"maomaozi\";\r\n        })(SkinName || (SkinName = {}));\r\n        let PropsName;\r\n        (function (PropsName) {\r\n            PropsName[\"yingguangbang\"] = \"yingguangbang\";\r\n            PropsName[\"lifadao\"] = \"lifadao\";\r\n            PropsName[\"jiandao\"] = \"jiandao\";\r\n            PropsName[\"dianjupian\"] = \"dianjupian\";\r\n            PropsName[\"dianju\"] = \"dianju\";\r\n        })(PropsName || (PropsName = {}));\r\n        let OtherName;\r\n        (function (OtherName) {\r\n            OtherName[\"xiangsudao\"] = \"xiangsudao\";\r\n            OtherName[\"tixudao\"] = \"tixudao\";\r\n            OtherName[\"ruwu\"] = \"ruwu\";\r\n            OtherName[\"lifadao\"] = \"lifadao\";\r\n            OtherName[\"jundao\"] = \"jundao\";\r\n            OtherName[\"tulongdao\"] = \"tulongdao\";\r\n        })(OtherName || (OtherName = {}));\r\n        Tools.objPropertySort(Shop.allSkin, 'arrange');\r\n        Tools.objPropertySort(Shop.allProps, 'arrange');\r\n        Tools.objPropertySort(Shop.allOther, 'arrange');\r\n        if (!Shop._currentSkin.name) {\r\n            Shop._currentSkin.name = SkinName.anquanmao;\r\n        }\r\n        if (!Shop._currentProp.name) {\r\n            Shop._currentProp.name = PropsName.jiandao;\r\n        }\r\n        if (!Shop._currentOther.name) {\r\n            Shop._currentOther.name = OtherName.tixudao;\r\n        }\r\n        this.self['Dispaly'].skin = 'UI/Shop/Other/' + Shop._currentOther.name + '.png';\r\n        let condition = Shop.getGoodsProperty(Shop.GoodsClass.Skin, SkinName.xiaochoumao, Shop.GoodsProperty.condition);\r\n        if (Game._gameLevel.value >= condition) {\r\n            Shop.setGoodsProperty(Shop.GoodsClass.Skin, SkinName.xiaochoumao, Shop.GoodsProperty.have, true);\r\n        }\r\n        else {\r\n            Shop.setGoodsProperty(Shop.GoodsClass.Skin, SkinName.xiaochoumao, Shop.GoodsProperty.resCondition, Game._gameLevel.value);\r\n        }\r\n        this.buyPriceDisplay();\r\n    }\r\n    buyPriceDisplay() {\r\n        let noHaveGold = [];\r\n        switch (Shop._ShopTap.selectedIndex) {\r\n            case 2:\r\n                noHaveGold = Shop.getwayGoldArr(Shop.GoodsClass.Skin, false);\r\n                break;\r\n            case 1:\r\n                noHaveGold = Shop.getwayGoldArr(Shop.GoodsClass.Props, false);\r\n                break;\r\n            case 0:\r\n                noHaveGold = Shop.getwayGoldArr(Shop.GoodsClass.Other, false);\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n        Tools.objPropertySort(noHaveGold, Shop.GoodsProperty.getOder);\r\n        if (noHaveGold[0]) {\r\n            let price = noHaveGold[0][Shop.GoodsProperty.condition];\r\n            this.self['BuyPrice'].value = price.toString();\r\n        }\r\n    }\r\n    shopEventReg() {\r\n        EventAdmin.reg(Shop.EventType.select, this, (dataSource) => {\r\n            if (dataSource.have) {\r\n                this.sceletDisplay(dataSource, false);\r\n            }\r\n            else {\r\n                if (dataSource[Shop.GoodsProperty.getway] === Shop.Getway.ads) {\r\n                    ADManager.ShowReward(() => {\r\n                        this.adsAcquisition(dataSource);\r\n                        switch (dataSource.name) {\r\n                            case 'yingguangbang':\r\n                                ADManager.TAPoint(TaT.BtnClick, 'Adjiguangjjian_get');\r\n                                break;\r\n                            case 'yuanyanjing':\r\n                                ADManager.TAPoint(TaT.BtnClick, 'ADyuan_ge');\r\n                                break;\r\n                            case 'xingxingyanjing':\r\n                                ADManager.TAPoint(TaT.BtnClick, 'Adstar_get');\r\n                                break;\r\n                            case 'jiemao_01':\r\n                                ADManager.TAPoint(TaT.BtnClick, 'ADjiemao1_get');\r\n                                break;\r\n                            case 'jiemao_02':\r\n                                ADManager.TAPoint(TaT.BtnClick, 'ADjiemao2_get');\r\n                                break;\r\n                            case 'hamajing':\r\n                                ADManager.TAPoint(TaT.BtnClick, 'Adhama_get');\r\n                                break;\r\n                            case 'yanshemao_gangtie':\r\n                                ADManager.TAPoint(TaT.BtnClick, 'Adiron_get');\r\n                                break;\r\n                            case 'yanshemao':\r\n                                ADManager.TAPoint(TaT.BtnClick, 'Adtomato_get');\r\n                                break;\r\n                            case 'maomaozi':\r\n                                ADManager.TAPoint(TaT.BtnClick, 'Adcat_get');\r\n                                break;\r\n                            case 'xiangsudao':\r\n                                ADManager.TAPoint(TaT.BtnClick, 'Adxiangsu_get');\r\n                                break;\r\n                            default:\r\n                                break;\r\n                        }\r\n                    });\r\n                }\r\n                else if (dataSource[Shop.GoodsProperty.getway] === Shop.Getway.adsXD) {\r\n                    Dialog.createHint_Middle(Dialog.HintContent[\"请前往皮肤限定界面获取!\"]);\r\n                }\r\n                else if (dataSource[Shop.GoodsProperty.getway] === Shop.Getway.ineedwin) {\r\n                    Dialog.createHint_Middle(Dialog.HintContent[\"通过相应的关卡数达到就可以得到了!\"]);\r\n                }\r\n                else if (dataSource[Shop.GoodsProperty.getway] === Shop.Getway.gold) {\r\n                    Dialog.createHint_Middle(Dialog.HintContent[\"点击金币抽奖按钮购买!\"]);\r\n                }\r\n            }\r\n        });\r\n        Shop._ShopList.refresh();\r\n    }\r\n    sceletDisplay(dataSource, scrollTo) {\r\n        switch (Shop._ShopTap.selectedIndex) {\r\n            case 2:\r\n                Shop._currentSkin.name = dataSource.name;\r\n                this.self['Dispaly'].skin = 'UI/Shop/Skin/' + dataSource.name + '.png';\r\n                break;\r\n            case 1:\r\n                Shop._currentProp.name = dataSource.name;\r\n                this.self['Dispaly'].skin = 'UI/Shop/Props/' + dataSource.name + '.png';\r\n                break;\r\n            case 0:\r\n                Shop._currentOther.name = dataSource.name;\r\n                this.self['Dispaly'].skin = 'UI/Shop/Other/' + dataSource.name + '.png';\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n        if (scrollTo) {\r\n            let index = dataSource.arrange - 1;\r\n            Shop._ShopList.scrollTo(index);\r\n        }\r\n    }\r\n    adsAcquisition(dataSource) {\r\n        let claName;\r\n        switch (Shop._ShopTap.selectedIndex) {\r\n            case 2:\r\n                claName = Shop.GoodsClass.Skin;\r\n                break;\r\n            case 1:\r\n                claName = Shop.GoodsClass.Props;\r\n                break;\r\n            case 0:\r\n                claName = Shop.GoodsClass.Other;\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n        let condition = Shop.getGoodsProperty(claName, dataSource.name, Shop.GoodsProperty.condition);\r\n        let resCondition = Shop.getGoodsProperty(claName, dataSource.name, Shop.GoodsProperty.resCondition);\r\n        Shop.setGoodsProperty(claName, dataSource.name, Shop.GoodsProperty.resCondition, resCondition + 1);\r\n        if (condition <= resCondition + 1) {\r\n            Shop.setGoodsProperty(claName, dataSource.name, Shop.GoodsProperty.have, true);\r\n            this.sceletDisplay(dataSource, false);\r\n        }\r\n        Shop._ShopList.refresh();\r\n    }\r\n    myTap_Select(index) {\r\n        PalyAudio.playSound();\r\n        switch (index) {\r\n            case 2:\r\n                Shop._ShopList.array = Shop.allSkin;\r\n                this.self['Dispaly'].skin = 'UI/Shop/Skin/' + Shop._currentSkin.name + '.png';\r\n                break;\r\n            case 1:\r\n                Shop._ShopList.array = Shop.allProps;\r\n                this.self['Dispaly'].skin = 'UI/Shop/Props/' + Shop._currentProp.name + '.png';\r\n                break;\r\n            case 0:\r\n                Shop._ShopList.array = Shop.allOther;\r\n                this.self['Dispaly'].skin = 'UI/Shop/Other/' + Shop._currentOther.name + '.png';\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n        Shop._ShopList.refresh();\r\n        this.buyPriceDisplay();\r\n    }\r\n    myList_Update(cell, index) {\r\n        let dataSource = cell.dataSource;\r\n        let Select = cell.getChildByName('Select');\r\n        Select.visible = false;\r\n        let Pic = cell.getChildByName('Pic');\r\n        switch (Shop._ShopTap.selectedIndex) {\r\n            case 2:\r\n                Pic.skin = 'UI/Shop/Skin/' + dataSource.name + '.png';\r\n                if (cell.dataSource[Shop.GoodsProperty.name] == Shop._currentSkin.name) {\r\n                    Select.visible = true;\r\n                }\r\n                else {\r\n                    Select.visible = false;\r\n                }\r\n                break;\r\n            case 1:\r\n                Pic.skin = 'UI/Shop/Props/' + dataSource.name + '.png';\r\n                if (cell.dataSource[Shop.GoodsProperty.name] == Shop._currentProp.name) {\r\n                    Select.visible = true;\r\n                }\r\n                else {\r\n                    Select.visible = false;\r\n                }\r\n                break;\r\n            case 0:\r\n                Pic.skin = 'UI/Shop/Other/' + dataSource.name + '.png';\r\n                if (cell.dataSource[Shop.GoodsProperty.name] == Shop._currentOther.name) {\r\n                    Select.visible = true;\r\n                }\r\n                else {\r\n                    Select.visible = false;\r\n                }\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n        let NoHave = cell.getChildByName('NoHave');\r\n        NoHave.visible = true;\r\n        let Board = cell.getChildByName('Board');\r\n        let Dec = NoHave.getChildByName('Dec');\r\n        let Icon = NoHave.getChildByName('Icon');\r\n        if (!cell.dataSource[Shop.GoodsProperty.have]) {\r\n            switch (cell.dataSource[Shop.GoodsProperty.getway]) {\r\n                case Shop.Getway.ads:\r\n                    Dec.text = cell.dataSource[Shop.GoodsProperty.resCondition] + '/' + cell.dataSource[Shop.GoodsProperty.condition];\r\n                    Dec.x = 88;\r\n                    Dec.fontSize = 30;\r\n                    Icon.visible = true;\r\n                    break;\r\n                case Shop.Getway.adsXD:\r\n                    Dec.text = '限定获取';\r\n                    Dec.x = NoHave.width / 2;\r\n                    Dec.fontSize = 23;\r\n                    Icon.visible = false;\r\n                    break;\r\n                case Shop.Getway.easterEgg:\r\n                    Dec.text = '彩蛋获取';\r\n                    Dec.x = NoHave.width / 2;\r\n                    Dec.fontSize = 23;\r\n                    Icon.visible = false;\r\n                    break;\r\n                case Shop.Getway.ineedwin:\r\n                    Dec.text = '过' + cell.dataSource[Shop.GoodsProperty.resCondition] + '/' + cell.dataSource[Shop.GoodsProperty.condition] + '关';\r\n                    Dec.x = NoHave.width / 2;\r\n                    Dec.fontSize = 23;\r\n                    Icon.visible = false;\r\n                    break;\r\n                case Shop.Getway.gold:\r\n                    Dec.text = '金币抽取';\r\n                    Dec.x = NoHave.width / 2;\r\n                    Dec.fontSize = 23;\r\n                    Icon.visible = false;\r\n                    break;\r\n                default:\r\n                    Icon.visible = false;\r\n                    break;\r\n            }\r\n            Board.skin = 'UI/Common/kuang2.png';\r\n        }\r\n        else {\r\n            NoHave.visible = false;\r\n            Board.skin = 'UI/Common/kuang1.png';\r\n        }\r\n    }\r\n    lwgBtnClick() {\r\n        Click.on(Click.Type.largen, this.self['BtnBuy'], this, null, null, this.btnBuyUp);\r\n        Click.on(Click.Type.largen, this.self['BtnGetGold'], this, null, null, this.btnGetGold);\r\n        Click.on(Click.Type.largen, this.self['BtnBack'], this, null, null, this.btnBackUp);\r\n    }\r\n    btnBuyUp() {\r\n        ADManager.TAPoint(TaT.BtnShow, 'Adcoinget');\r\n        let noHaveGold = [];\r\n        switch (Shop._ShopTap.selectedIndex) {\r\n            case 2:\r\n                noHaveGold = Shop.getwayGoldArr(Shop.GoodsClass.Skin, false);\r\n                break;\r\n            case 1:\r\n                noHaveGold = Shop.getwayGoldArr(Shop.GoodsClass.Props, false);\r\n                break;\r\n            case 0:\r\n                noHaveGold = Shop.getwayGoldArr(Shop.GoodsClass.Other, false);\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n        if (noHaveGold.length <= 0) {\r\n            Dialog.createHint_Middle(Dialog.HintContent[\"没有可以购买的皮肤了！\"]);\r\n        }\r\n        else {\r\n            Tools.objPropertySort(noHaveGold, Shop.GoodsProperty.getOder);\r\n            let price = noHaveGold[0][Shop.GoodsProperty.condition];\r\n            if (noHaveGold[1]) {\r\n                let price1 = noHaveGold[1][Shop.GoodsProperty.condition];\r\n                this.self['BuyPrice'].value = price1.toString();\r\n            }\r\n            if (Gold._goldNum < price) {\r\n                Dialog.createHint_Middle(Dialog.HintContent[\"金币不够了！\"]);\r\n            }\r\n            else {\r\n                Dialog.createHint_Middle(Dialog.HintContent[\"恭喜获得新皮肤!\"]);\r\n                switch (Shop._ShopTap.selectedIndex) {\r\n                    case 2:\r\n                        Shop.setGoodsProperty(Shop.GoodsClass.Skin, noHaveGold[0].name, Shop.GoodsProperty.have, true);\r\n                        break;\r\n                    case 1:\r\n                        Shop.setGoodsProperty(Shop.GoodsClass.Props, noHaveGold[0].name, Shop.GoodsProperty.have, true);\r\n                        break;\r\n                    case 0:\r\n                        Shop.setGoodsProperty(Shop.GoodsClass.Other, noHaveGold[0].name, Shop.GoodsProperty.have, true);\r\n                        break;\r\n                    default:\r\n                        break;\r\n                }\r\n                this.sceletDisplay(noHaveGold[0], true);\r\n                Gold.addGold(-price);\r\n            }\r\n            Shop._ShopList.refresh();\r\n        }\r\n    }\r\n    btnGetGold() {\r\n        ADManager.ShowReward(() => {\r\n            ADManager.TAPoint(TaT.BtnClick, 'ADrewardbt_skin');\r\n            Gold.getGoldAni_Heap(Laya.stage, 15, 88, 69, 'UI/GameStart/qian.png', new Laya.Point(Laya.stage.width / 2, Laya.stage.height / 2), new Laya.Point(Gold.GoldNode.x - 80, Gold.GoldNode.y), null, () => {\r\n                this.advFunc();\r\n            });\r\n        });\r\n    }\r\n    advFunc() {\r\n        Gold.addGold(500);\r\n    }\r\n    btnBackUp() {\r\n        ADManager.TAPoint(TaT.BtnClick, 'closeword_skin');\r\n        this.self.close();\r\n    }\r\n    shopOnDisable() {\r\n        GVariate._stageClick = true;\r\n        Setting.setBtnAppear();\r\n    }\r\n}\r\n",
  "references": [
    "D:/Game/project/CutHair/Project/CutHair/src/script/Lwg_Template/lwg.ts",
    "D:/Game/project/CutHair/Project/CutHair/src/script/Lwg_Template/Global.ts",
    "D:/Game/project/CutHair/Project/CutHair/src/script/TJ/Admanager.ts",
    "D:/Game/project/CutHair/Project/CutHair/src/script/Lwg_Template/Game.ts"
  ]
}
