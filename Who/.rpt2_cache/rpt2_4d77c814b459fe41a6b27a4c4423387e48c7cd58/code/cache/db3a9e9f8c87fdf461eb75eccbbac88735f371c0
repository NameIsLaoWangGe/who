{
  "code": "import { Admin, DrawCard, Click, EventAdmin, Animation2D, Effects } from \"../Frame/lwg\";\r\nexport default class UIDrawCard extends DrawCard.DrawCardScene {\r\n    lwgOnAwake() {\r\n    }\r\n    lwgOnEnable() {\r\n    }\r\n    lwgEventReg() {\r\n        let Img = this.self['Surface'];\r\n        let globalPos = Img.localToGlobal(new Laya.Point(Img.width / 2, Img.height / 2));\r\n        EventAdmin.reg('drawCard', this, () => {\r\n            this.self['DrawDisPlay'].x = 0;\r\n            this.self['BtnTake'].visible = false;\r\n            for (let index = 0; index < 10; index++) {\r\n                Laya.timer.once(index * 100, this, () => {\r\n                    let Card = Laya.Pool.getItemByCreateFun('Card', this.Card.create, this.Card);\r\n                    this.self['CardParent'].addChild(Card);\r\n                    let spcing = (Laya.stage.width - 5 * Card.width) / 6;\r\n                    Card.pos(globalPos.x, globalPos.y);\r\n                    Card.scale(0, 0);\r\n                    Card.name = 'Card' + index;\r\n                    let Pic = Card.getChildByName('Pic');\r\n                    Pic.visible = false;\r\n                    let x, y;\r\n                    if (index <= 4) {\r\n                        x = (spcing + Card.width / 2) + (Card.width + spcing) * index;\r\n                        y = globalPos.y - 150;\r\n                    }\r\n                    else {\r\n                        x = (spcing + Card.width / 2) + (Card.width + spcing) * (index - 5);\r\n                        y = globalPos.y + 150;\r\n                    }\r\n                    Animation2D.move_Scale(Card, 0, globalPos.x, globalPos.y, x, y, 1, 200);\r\n                    if (index == 8) {\r\n                        Animation2D.fadeOut(this.self['DrawDisPlayBg'], 0, 0.5, 300);\r\n                    }\r\n                    else if (index == 9) {\r\n                        EventAdmin.notify('flop');\r\n                    }\r\n                });\r\n            }\r\n        });\r\n        EventAdmin.reg('flop', this, () => {\r\n            if (!this.self['cardIndex']) {\r\n                this.self['cardIndex'] = 0;\r\n            }\r\n            let Card = this.self['CardParent'].getChildByName('Card' + this.self['cardIndex']);\r\n            if (!Card) {\r\n                return;\r\n            }\r\n            Animation2D.cardRotateX_OneFace(Card, () => {\r\n                let Pic = Card.getChildByName('Pic');\r\n                Pic.visible = true;\r\n            }, 100, 50, () => {\r\n                if (this.self['cardIndex'] == 4) {\r\n                    Card.zOrder = 4 * 10;\r\n                    let x = Card.x;\r\n                    let y = Card.y;\r\n                    Animation2D.leftRight_Shake(Card, 20, 100, 200, () => {\r\n                        Effects.createExplosion_Rotate(this.self['SceneContent'], 40, this.self['SceneContent'].width / 2, this.self['SceneContent'].height / 2 - 100, Effects.SkinStyle.star, 20, 15);\r\n                        Animation2D.rotate_Scale(Card, 0, 1, 1, 720, 3, 3, 400, 200, () => {\r\n                            Animation2D.move_Scale(Card, 3, Card.x, Card.y, x, y, 1, 200, 2000, null, () => {\r\n                                this.self['cardIndex']++;\r\n                                EventAdmin.notify('flop');\r\n                            });\r\n                        });\r\n                        Animation2D.move_Simple(Card, x, y, globalPos.x, globalPos.y, 250, 100);\r\n                    });\r\n                }\r\n                else {\r\n                    this.self['cardIndex']++;\r\n                    EventAdmin.notify('flop');\r\n                }\r\n            });\r\n        });\r\n    }\r\n    lwgBtnClick() {\r\n        Click.on(Click.Type.largen, this.self['BtnBack'], this, null, null, () => {\r\n            Admin._openScene(Admin.SceneName.UIStart, this.self);\r\n        });\r\n        Click.on(Click.Type.noEffect, this.self['DrawDisPlay'], this, (e) => {\r\n            e.stopPropagation();\r\n        }, null, null);\r\n        Click.on(Click.Type.noEffect, this.self['Surface'], this, (e) => {\r\n            if (!this.self.getChildByName('DrawSp')) {\r\n                this.self['Drawlength'] = 0;\r\n                let DrawSp = new Laya.Sprite();\r\n                this.self.addChild(DrawSp);\r\n                DrawSp.name = 'DrawSp';\r\n                DrawSp.pos(0, 0);\r\n                this.self['DrawSp'] = DrawSp;\r\n            }\r\n            this.self['DrawPosArr'] = new Laya.Point(e.stageX, e.stageY);\r\n        }, (e) => {\r\n            let Img = this.self['Surface'];\r\n            let globalPos = Img.localToGlobal(new Laya.Point(Img.width / 2, Img.height / 2));\r\n            if (new Laya.Point(e.stageX, e.stageY).distance(globalPos.x, globalPos.y) > Img.width / 2) {\r\n                this.self['DrawPosArr'] = null;\r\n                return;\r\n            }\r\n            if (this.self['DrawPosArr']) {\r\n                this.self['DrawSp'].graphics.drawLine(this.self['DrawPosArr'].x, this.self['DrawPosArr'].y, e.stageX, e.stageY, \"#000000\", 8);\r\n                this.self['DrawSp'].graphics.drawCircle(e.stageX, e.stageY, 4, \"#000000\");\r\n                this.self['Drawlength'] += this.self['DrawPosArr'].distance(e.stageX, e.stageY);\r\n                this.self['DrawPosArr'] = new Laya.Point(e.stageX, e.stageY);\r\n            }\r\n        }, () => {\r\n            if (this.self['Drawlength'] > 2000) {\r\n                console.log('画线长度够了，弹出十连抽！');\r\n                this.self.getChildByName('DrawSp').removeSelf();\r\n                EventAdmin.notify('drawCard');\r\n            }\r\n            this.self['DrawPosArr'] = null;\r\n        }, () => {\r\n            this.self['DrawPosArr'] = null;\r\n        });\r\n    }\r\n}\r\n",
  "references": [
    "D:/Game/project/Who/Project/Who/src/script/Frame/lwg.ts"
  ]
}
