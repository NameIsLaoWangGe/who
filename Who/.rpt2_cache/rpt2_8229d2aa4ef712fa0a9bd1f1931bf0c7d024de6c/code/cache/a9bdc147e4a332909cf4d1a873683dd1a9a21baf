{
  "code": "import { Admin, Dialog, Click, EventAdmin, Tools, Animation2D, Gold, Effects, Share, Backpack, Color } from \"../Frame/lwg\";\r\nimport { Game3D } from \"./Game3D\";\r\nexport default class GameScene extends Admin.Scene {\r\n    lwgOnAwake() {\r\n        Gold.goldAppear();\r\n    }\r\n    lwgAdaptive() {\r\n        this.self['SceneContent'].y = Laya.stage.height * 0.792;\r\n    }\r\n    lwgOnEnable() {\r\n        EventAdmin.notify(Game3D.EventType.opening);\r\n        this.self['BtnSCNum'].text = Backpack._prop1.num;\r\n        this.self['BtnSXNum'].text = Backpack._prop2.num;\r\n        this.self['SceneContent'].alpha = 0;\r\n    }\r\n    lwgBtnClick() {\r\n        Click.on(Click.Type.largen, this.self['BtnBack'], this, null, null, () => {\r\n            Admin._openScene(Admin.SceneName.UIStart, this.self);\r\n            EventAdmin.notify(EventAdmin.EventType.nextCustoms);\r\n        });\r\n        var refreshQuestion = () => {\r\n            Animation2D.fadeOut(this.self['OptionParent'], 1, 0, 300, 0, () => {\r\n                this.createQuestion(Game3D.setRefrashAnswerForMe());\r\n                Animation2D.fadeOut(this.self['OptionParent'], 0, 1, 300, 0);\r\n            });\r\n        };\r\n        Click.on(Click.Type.largen, this.self['BtnSC'], this, null, null, () => {\r\n            if (Backpack._prop1.num <= 0) {\r\n                Dialog.createHint_Middle(Dialog.HintContent[\"没有库存了！\"]);\r\n                return;\r\n            }\r\n            let numArr = Game3D.getNotFallCard(Game3D.MyCardParent);\r\n            if (numArr.length <= 2) {\r\n                Dialog.createHint_Middle(Dialog.HintContent[\"牌数太少，无法使用道具！\"]);\r\n                return;\r\n            }\r\n            Backpack._prop1.num--;\r\n            this.self['BtnSCNum'].text = Tools.format_StrAddNum(this.self['BtnSCNum'].text, -1);\r\n            let arr = Tools.node_RandomChildren(this.self['OptionParent']);\r\n            let question = arr[0].getChildByName('Content').text;\r\n            EventAdmin.notify(Game3D.EventType.BtnSC, [question]);\r\n            Laya.timer.once(3000, this, () => {\r\n                refreshQuestion();\r\n            });\r\n        });\r\n        Click.on(Click.Type.largen, this.self['BtnSX'], this, null, null, () => {\r\n            if (Backpack._prop2.num <= 0) {\r\n                Dialog.createHint_Middle(Dialog.HintContent[\"没有库存了！\"]);\r\n                return;\r\n            }\r\n            let numArr = Game3D.getNotFallCard(Game3D.MyCardParent);\r\n            if (numArr.length <= 2) {\r\n                Dialog.createHint_Middle(Dialog.HintContent[\"牌数太少，无法使用道具！\"]);\r\n                return;\r\n            }\r\n            Backpack._prop2.num--;\r\n            this.self['BtnSXNum'].text = Tools.format_StrAddNum(this.self['BtnSXNum'].text, -1);\r\n            refreshQuestion();\r\n        });\r\n    }\r\n    lwgEventReg() {\r\n        EventAdmin.reg(Game3D.EventType.oppositeAnswer, this, (questionAndYesOrNo, cardName) => {\r\n            Animation2D.fadeOut(this.self['SceneContent'], this.self['SceneContent'].alpha, 0, 300, 0, () => {\r\n                this.createOppositeQuestion(questionAndYesOrNo, cardName);\r\n            });\r\n        });\r\n        EventAdmin.reg(Game3D.EventType.meAnswer, this, (questionArr) => {\r\n            this.createQuestion(questionArr);\r\n            Animation2D.fadeOut(this.self['SceneContent'], 0, 1, 300, 0);\r\n        });\r\n        EventAdmin.reg(EventAdmin.EventType.victory, this, () => {\r\n            Admin._openScene(Admin.SceneName.UIShare, this.self, () => { Share._fromWhich = Admin.SceneName.UIVictory; });\r\n        });\r\n        EventAdmin.reg(EventAdmin.EventType.defeated, this, () => {\r\n            Admin._openScene(Admin.SceneName.UIResurgence);\r\n        });\r\n        EventAdmin.reg(EventAdmin.EventType.resurgence, this, () => {\r\n            Animation2D.fadeOut(this.self['SceneContent'], 1, 0.5, 500, 100);\r\n        });\r\n        EventAdmin.reg(Game3D.EventType.hideOption, this, () => {\r\n            Animation2D.fadeOut(this.self['SceneContent'], 1, 0.5, 500, 100);\r\n        });\r\n        EventAdmin.reg(Game3D.EventType.doWell, this, () => {\r\n            let DoWell = Laya.Pool.getItemByCreateFun('DoWell', this.DoWell.create, this.DoWell);\r\n            Laya.stage.addChild(DoWell);\r\n            DoWell.pos(Laya.stage.width / 2, Laya.stage.height / 2 - 150);\r\n            Animation2D.bombs_AppearAllChild(DoWell, 0, 1, 1.1, Tools.randomOneHalf() == 0 ? 15 : -15, 200, 100, 200);\r\n            for (let index = 0; index < 5; index++) {\r\n                let pointAarr = Tools.point_RandomPointByCenter(new Laya.Point(Laya.stage.width / 2, Laya.stage.height / 2 - 150), 200, 100);\r\n                Laya.timer.once(300 * index, this, () => {\r\n                    Effects.createExplosion_Rotate(this.self, 25, pointAarr[0].x, pointAarr[0].y, 'star', 10, 10);\r\n                });\r\n            }\r\n            Laya.timer.once(1500, this, () => {\r\n                Animation2D.bombs_Vanish(DoWell, 0, 1, 1.1, Tools.randomOneHalf() == 0 ? 15 : -15, 200);\r\n            });\r\n        });\r\n    }\r\n    createQuestion(questionArr) {\r\n        Tools.node_RemoveAllChildren(this.self['OptionParent']);\r\n        if (questionArr.length < 3) {\r\n            this.createOption(this.self['OptionParent'], this.self['OptionParent'].width / 2, this.self['OptionParent'].height / 2, questionArr[0], false);\r\n        }\r\n        else {\r\n            for (let index = 0; index < questionArr.length; index++) {\r\n                let x, y;\r\n                switch (index) {\r\n                    case 0:\r\n                        x = this.self['OptionParent'].width * 0.25;\r\n                        y = this.self['OptionParent'].height * 0.25;\r\n                        break;\r\n                    case 1:\r\n                        x = this.self['OptionParent'].width * 0.75;\r\n                        y = this.self['OptionParent'].height * 0.25;\r\n                        break;\r\n                    case 2:\r\n                        x = this.self['OptionParent'].width * 0.25;\r\n                        y = this.self['OptionParent'].height * 0.75;\r\n                        break;\r\n                    case 3:\r\n                        x = this.self['OptionParent'].width * 0.75;\r\n                        y = this.self['OptionParent'].height * 0.75;\r\n                        break;\r\n                    default:\r\n                        break;\r\n                }\r\n                this.createOption(this.self['OptionParent'], x, y, questionArr[index], true);\r\n            }\r\n        }\r\n    }\r\n    createOption(parent, x, y, question, click) {\r\n        Admin._clickLock.switch = false;\r\n        let Option = Laya.Pool.getItemByCreateFun('Option', this.Option.create, this.Option);\r\n        let Content = Option.getChildByName('Content');\r\n        Content.text = question;\r\n        parent.addChild(Option);\r\n        Option.pos(x, y);\r\n        if (Content.text.length >= 10) {\r\n            Content.fontSize = 22;\r\n        }\r\n        else if (Content.text.length >= 8 && Content.text.length < 10) {\r\n            Content.fontSize = 25;\r\n        }\r\n        else if (Content.text.length >= 6 && Content.text.length < 8) {\r\n            Content.fontSize = 28;\r\n        }\r\n        else if (Content.text.length < 6) {\r\n            Content.fontSize = 30;\r\n        }\r\n        if (click) {\r\n            Click.on(Click.Type.largen, Option, this, null, null, () => {\r\n                Admin._clickLock.switch = true;\r\n                EventAdmin.notify(Game3D.EventType.judgeMeAnswer, question);\r\n            });\r\n        }\r\n        return Option;\r\n    }\r\n    createOppositeQuestion(questionAndYesOrNo, cardName) {\r\n        Admin._clickLock.switch = false;\r\n        let GuessCard = Laya.Pool.getItemByCreateFun('GuessCard', this.GuessCard.create, this.GuessCard);\r\n        this.self.addChild(GuessCard);\r\n        GuessCard.pos(0, 0);\r\n        let Bg = GuessCard.getChildByName('Bg');\r\n        Bg.alpha = 0;\r\n        Bg.height = Laya.stage.height;\r\n        Bg.width = Laya.stage.width;\r\n        Animation2D.fadeOut(Bg, 0, 0.3, 200, 300);\r\n        let QuestionBaord = GuessCard.getChildByName('QuestionBaord');\r\n        let Question = QuestionBaord.getChildByName('Question');\r\n        Question.text = questionAndYesOrNo[0];\r\n        Animation2D.bombs_Appear(QuestionBaord, 0, 1, 1.1, 0, 150, 50, 600);\r\n        let Card = GuessCard.getChildByName('Card');\r\n        let CardName = Card.getChildByName('CardName');\r\n        CardName.text = cardName;\r\n        Card.y = Laya.stage.height * 0.483;\r\n        Animation2D.cardRotateX_TowFace(Card, 180);\r\n        Animation2D.move_Simple(Card, -800, Card.y, Laya.stage.width / 2, Card.y, 500);\r\n        let BtnYes = GuessCard.getChildByName('BtnYes');\r\n        var btnYesUp = () => {\r\n            Admin._clickLock.switch = true;\r\n            if (questionAndYesOrNo[1]) {\r\n                EventAdmin.notify(Game3D.EventType.judgeOppositeAnswer, [questionAndYesOrNo[0], true]);\r\n            }\r\n            else {\r\n                Color.colour(Card, [255, 0, 0, 1], 100);\r\n                Animation2D.swell_shrink(Card, 1, 1.05, 80);\r\n                Animation2D.leftRight_Shake(Card, 30, 50, 0, () => {\r\n                    Admin._clickLock.switch = false;\r\n                    console.log('回答错误！');\r\n                }, false);\r\n            }\r\n        };\r\n        Click.on(Click.Type.largen, BtnYes, this, null, null, btnYesUp);\r\n        let BtnNo = GuessCard.getChildByName('BtnNo');\r\n        var btnNoUp = () => {\r\n            Admin._clickLock.switch = true;\r\n            if (!questionAndYesOrNo[1]) {\r\n                EventAdmin.notify(Game3D.EventType.judgeOppositeAnswer, [questionAndYesOrNo[0], false]);\r\n            }\r\n            else {\r\n                Color.colour(Card, [255, 0, 0, 1], 100);\r\n                Animation2D.swell_shrink(Card, 1, 1.05, 80);\r\n                Animation2D.leftRight_Shake(Card, 30, 50, 0, () => {\r\n                    Admin._clickLock.switch = false;\r\n                    console.log('回答错误！');\r\n                }, false);\r\n            }\r\n        };\r\n        Click.on(Click.Type.largen, BtnNo, this, null, null, btnNoUp);\r\n        BtnYes.y = Laya.stage.height * 0.874;\r\n        BtnNo.y = Laya.stage.height * 0.874;\r\n        Animation2D.scale_Alpha(BtnNo, 0, 0, 0, 1, 1, 1, 150, 600);\r\n        Animation2D.scale_Alpha(BtnYes, 0, 0, 0, 1, 1, 1, 150, 600);\r\n        EventAdmin.reg(Game3D.EventType.hideGuessCard, this, (func) => {\r\n            Animation2D.fadeOut(Bg, 0.3, 0, 200);\r\n            Animation2D.bombs_Vanish(QuestionBaord, 0, 0, 0, 150, 500);\r\n            Animation2D.move_Simple(Card, Card.x, Card.y, 1200, Card.y, 500, 150);\r\n            Animation2D.cardRotateX_TowFace(Card, 180, null, 200);\r\n            Animation2D.scale_Alpha(BtnNo, 1, 1, 1, 0, 0, 0, 150, 400);\r\n            Animation2D.scale_Alpha(BtnYes, 1, 1, 1, 0, 0, 0, 150, 400, () => {\r\n                GuessCard.removeSelf();\r\n                if (func) {\r\n                    func();\r\n                }\r\n            });\r\n        });\r\n    }\r\n    onStageMouseDown(e) {\r\n        let MainCamera = Game3D.MainCamera.getChildAt(0);\r\n        let hitResult = Tools.d3_rayScanning(MainCamera, Game3D.Scene3D, new Laya.Vector2(e.stageX, e.stageY))[0];\r\n        let Sp3D;\r\n        if (hitResult && !Admin._clickLock.switch) {\r\n            Sp3D = hitResult.collider.owner;\r\n            EventAdmin.notify(Game3D.EventType.judgeMeClickCard, Sp3D);\r\n        }\r\n    }\r\n}\r\n",
  "references": [
    "D:/Game/project/Who/Project/Who/src/script/Frame/lwg.ts",
    "D:/Game/project/Who/Project/Who/src/script/Game/Game3D.ts",
    "D:/Game/project/Who/Project/Who/src/script/Game/UIADSHint.ts"
  ]
}
